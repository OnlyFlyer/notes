## 影响一个 http 请求的因素有两个

1. 带宽

以前可能会影响，但现在网速贼快，一般情况不会因为带宽而影响网速

2. 延迟

1. 浏览器阻塞，7个连接，要跟不同的浏览器内核有关系
2. DNS 查询，DNS 缓存
3. 建立连接，http是基于tcp协议，浏览器最快也要在三次握手后才能携带http请求报文，连接无法复用会导致每次请求都经历三次握手和慢启动。三次握手在高延迟的场景下影响较明显，慢启动则对文件类大请求影响较大。


## http 1.0 和 http 1.1 的区别

#### 缓存处理

1. http 1.0 主要通过 header 里面的 If-Modifield-Since，Expires 来作为缓存判断的标志
2. http 1.1 引入了更多例如 Entity tag，If-Unmodified-Since, If-Match, If-None-Match等可供选择的缓存头来控制缓存策略

#### 带宽优化及网络连接的使用

1. http 1.0 不支持断点续传功能，http 1.1 在请求头引入了 range 头域，它允许只请求某个资源的一部分，即返回码是 206(Partial Content)，http 1.1 新增了24个状态码，409（Conflict）请求资源与当前资源冲突，410（Gone）服务器上某个资源被永久删除。

#### Host 头处理

1. http 1.0 认为每台服务器都绑定唯一一个IP地址，因此，请求消息中的URL并没有传递主机名（hostname），但伴随虚拟主机的发展，一台物理服务器上可以存在多个虚拟主机，且他们共享一个IP地址，http 1.1 的请求消息和相应消息都支持 Host 头域，且消息中如果没有 Host 头域会报告一个错误（400 Bad Request）

#### 支持长连接

1. http 1.1 支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个 TCP 连接上可以传送多个 HTTP 请求和响应，减少了建立和关闭连接的消耗和延迟，http 1.1 默认开启了 keep-alive

## http 1.x 存在的问题

1. 每次传输数据都会重新建立连接，增加了延迟时间，特别是在移动端
2. 1.X 传输的时候都是明文传输，客户端和服务端都无法验证对方的身份，无法保证数据的安全性
3. 1.x 在使用时， header 里面携带的内容太大，增加了传输的成本，且每次请求 header 基本不会变化，在移动端增加用户流量
4. 1.x 支持 keep-alive 来弥补多次创建连接的延迟，但使用太多也会对服务器带来性能压力，且对于单个文件被不断请求的服务，会带来很大的性能影响，因为它在文件被请求之后还保持了不必要的连接很长时间。

## HTTPS 与 HTTP 的区别

1. https 需要 ca 证书，免费证书很少，需要交费
2. http 协议运行在 tcp 之上，所有传输都是明文，https 运行在 ssl/tls 之上，ssl/tls 运行在tcp 之上，所有传输的内容都是加密过的
3. HTTP和HTTPS使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443
4. HTTPS可以有效的防止运营商劫持，解决了防劫持的一个大问题。

## HTTP2.0的新特性

1. 新的二进制格式（Binary Format）
2. 多路复用（MultiPlexing）
3. header压缩
4. 服务端推送（server push）


## 强制缓存与协商缓存

1. 强制缓存，Exprires、Cache-Controll

获取缓存数据库的内容，若未失效，使用
若已失效，请求目标服务器，返回数据和缓存规则，将新的缓存规则写到缓存系统


2. 协商缓存，304

获取缓存数据库的缓存规则，拿到后将缓存规则发送到目标服务器验证是否失效，
若未失效，返回304，从缓存数据库拿
若失效，返回新的数据和缓存规则，将新的缓存规则写到缓存系统

Last-Modified： 服务器在响应请求时，告诉浏览器资源最后修改时间
if-Modified-Since: 请求头带有这个字段，服务器收到这个字段，会与被请求资源的最后修改时间进行对比，如果一致则返回304和响应报文头，浏览器只需要从缓存中获取信息即可。 从字面上看，就是说：从某个时间节点算起，是否文件被修改了

如果真的被修改：那么开始传输响应一个整体，服务器返回：200 OK
如果没有被修改：那么只需传输响应header，服务器返回：304 Not Modified

if-Unmodified-Since： 从字面上看, 就是说: 从某个时间点算起, 是否文件没有被修改

如果没有被修改:则开始`继续'传送文件: 服务器返回: 200 OK
如果文件被修改:则不传输,服务器返回: 412 Precondition failed (预处理错误)

两种机制可以同时存在，强制缓存优先级高于协商缓存



